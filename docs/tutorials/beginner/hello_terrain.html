<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>jMonkeyEngine 3 Tutorial (10) - Hello Terrain :: jMonkeyEngine Docs</title>
    <link rel="canonical" href="https://mitm001.github.io/jme-wiki/docs/tutorials/beginner/hello_terrain.html">
    <link rel="prev" href="hello_collision.html">
    <link rel="next" href="hello_audio.html">
    <meta name="keywords" content="beginner, heightmap, documentation, terrain, texture">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
<meta property="og:image" content="https://wiki.jmonkeyengine.org/_/img/iconx128.png">
<meta property="og:description" content="jMonkeyEngine 3 Tutorial (10) - Hello Terrain">
<meta property="og:title" content="jMonkeyEngine Docs">
<link rel="stylesheet" href="../../../_/css/site-extra.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://mitm001.github.io/jme-wiki">
        <img alt="" src="../../../_/img/jme-logo.png" height="32" type="image/x-icon">
      </a>
      <div class="navbar-item hide-for-print">
        <input id="search-input" type="text" placeholder="Search docs">
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item theme-switch-wrapper">
          <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox" />
            <div class="slider round"></div>
          </label>
        </div>
        <a class="navbar-item" href="https://github.com/jmonkeyengine/wiki">Github</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../documentation.html">Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../documentation.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://javadoc.jmonkeyengine.org/v3.3.2-stable">JavaDoc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../jme3.html">jMonkeyEngine 3</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Intermediate Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/intermediate/best_practices.html">Best Practices</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/intermediate/simpleapplication.html">Simple Application</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/features.html">Features</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/intermediate/optimization.html">Optimization</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/faq.html">FAQ</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Math Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/math_for_dummies.html">Math For Dummies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/intermediate/math.html">Math</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/math.html">More Math</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/rotate.html">Rotate</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/math_video_tutorials.html">Math Video Tutorials</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">3D Graphics Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/intermediate/multi-media_asset_pipeline.html">Multi-Media Asset Pipeline</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/scenegraph_for_dummies.html">Scenegraph for Dummies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#jme3/beginner/hellovector.adoc">Hello Vector</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/terminology.html">Terminology</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/intermediate/how_to_use_materials.html">How to Use Materials</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/intermediate/transparency_sorting.html">Transparency and Sorting</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/external/blender.html">Importing from Blender</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../jme3/external/3dsmax.html">Importing from 3DS Max</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../logo.html">Logo Usage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../bsd_license.html">License</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../github_tips.html">Github Tips</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SDK</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../sdk.html">jMonkeyEngine SDK</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="beginner.html">Beginner tutorials</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_simpleapplication.html">Hello SimpleApplication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_node.html">Hello Node</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_asset.html">Hello Asset</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_main_event_loop.html">Hello Update Loop</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_input_system.html">Hello Input System</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_material.html">Hello Material</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_animation.html">Hello Animation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_picking.html">Hello Picking</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_collision.html">Hello Collision</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="hello_terrain.html">Hello Terrain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_audio.html">Hello Audio</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_effects.html">Hello Effects</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hello_physics.html">Hello Physics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hellovector.html">Hello Vector3f</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Docs</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../documentation.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Wiki UI</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../wiki-ui/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../documentation.html">Docs</a></li>
    <li>Tutorials</li>
    <li><a href="beginner.html">Beginner tutorials</a></li>
    <li><a href="hello_terrain.html">Hello Terrain</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/mitm001/jme-wiki/edit/modules/docs/modules/tutorials/pages/beginner/hello_terrain.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">jMonkeyEngine 3 Tutorial (10) - Hello Terrain</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>One way to create a 3D landscape is to sculpt a huge terrain model. This gives you a lot of artistic freedom – but rendering such a huge model can be quite slow. This tutorial explains how to create fast-rendering terrains from heightmaps, and how to use texture splatting to make the terrain look good.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../_images/beginner/beginner-terrain.png" alt="beginner-terrain.png" width="360" height="291">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you get an error when trying to create your <code>ImageBasedHeightMap</code> object, you may need to update the SDK, click on <code><span class="menuseq"><b class="menu">Help</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Check for Updates</b></span></code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To use the example assets in a new jMonkeyEngine SDK project, right-click your project, select <span class="menuseq"><b class="menu">Properties</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Libraries</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Add Library</b></span>, and add the &#8220;jme3-test-data&#8221; library.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sample-code"><a class="anchor" href="#sample-code"></a>Sample Code</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package jme3test.helloworld;

import com.jme3.app.SimpleApplication;
import com.jme3.material.Material;
import com.jme3.renderer.Camera;
import com.jme3.terrain.geomipmap.TerrainLodControl;
import com.jme3.terrain.heightmap.AbstractHeightMap;
import com.jme3.terrain.geomipmap.TerrainQuad;
import com.jme3.terrain.geomipmap.lodcalc.DistanceLodCalculator;
import com.jme3.terrain.heightmap.HillHeightMap; // for exercise 2
import com.jme3.terrain.heightmap.ImageBasedHeightMap;
import com.jme3.texture.Texture;
import com.jme3.texture.Texture.WrapMode;
import java.util.ArrayList;
import java.util.List;

/** Sample 10 - How to create fast-rendering terrains from heightmaps,
and how to use texture splatting to make the terrain look good.  */
public class HelloTerrain extends SimpleApplication {

  private TerrainQuad terrain;
  Material mat_terrain;

  public static void main(String[] args) {
    HelloTerrain app = new HelloTerrain();
    app.start();
  }

  @Override
  public void simpleInitApp() {
    flyCam.setMoveSpeed(50);

    /** 1. Create terrain material and load four textures into it. */
    mat_terrain = new Material(assetManager,
            "Common/MatDefs/Terrain/Terrain.j3md");

    /** 1.1) Add ALPHA map (for red-blue-green coded splat textures) */
    mat_terrain.setTexture("Alpha", assetManager.loadTexture(
            "Textures/Terrain/splat/alphamap.png"));

    /** 1.2) Add GRASS texture into the red layer (Tex1). */
    Texture grass = assetManager.loadTexture(
            "Textures/Terrain/splat/grass.jpg");
    grass.setWrap(WrapMode.Repeat);
    mat_terrain.setTexture("Tex1", grass);
    mat_terrain.setFloat("Tex1Scale", 64f);

    /** 1.3) Add DIRT texture into the green layer (Tex2) */
    Texture dirt = assetManager.loadTexture(
            "Textures/Terrain/splat/dirt.jpg");
    dirt.setWrap(WrapMode.Repeat);
    mat_terrain.setTexture("Tex2", dirt);
    mat_terrain.setFloat("Tex2Scale", 32f);

    /** 1.4) Add ROAD texture into the blue layer (Tex3) */
    Texture rock = assetManager.loadTexture(
            "Textures/Terrain/splat/road.jpg");
    rock.setWrap(WrapMode.Repeat);
    mat_terrain.setTexture("Tex3", rock);
    mat_terrain.setFloat("Tex3Scale", 128f);

    /** 2. Create the height map */
    AbstractHeightMap heightmap = null;
    Texture heightMapImage = assetManager.loadTexture(
            "Textures/Terrain/splat/mountains512.png");
    heightmap = new ImageBasedHeightMap(heightMapImage.getImage());
    heightmap.load();

    /** 3. We have prepared material and heightmap.
     * Now we create the actual terrain:
     * 3.1) Create a TerrainQuad and name it "my terrain".
     * 3.2) A good value for terrain tiles is 64x64 -- so we supply 64+1=65.
     * 3.3) We prepared a heightmap of size 512x512 -- so we supply 512+1=513.
     * 3.4) As LOD step scale we supply Vector3f(1,1,1).
     * 3.5) We supply the prepared heightmap itself.
     */
    int patchSize = 65;
    terrain = new TerrainQuad("my terrain", patchSize, 513, heightmap.getHeightMap());

    /** 4. We give the terrain its material, position &amp; scale it, and attach it. */
    terrain.setMaterial(mat_terrain);
    terrain.setLocalTranslation(0, -100, 0);
    terrain.setLocalScale(2f, 1f, 2f);
    rootNode.attachChild(terrain);

    /** 5. The LOD (level of detail) depends on were the camera is: */
    TerrainLodControl control = new TerrainLodControl(terrain, getCamera());
    terrain.addControl(control);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you run this sample you should see a landscape with dirt mountains, grass plains, plus some winding roads in between.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-a-heightmap"><a class="anchor" href="#what-is-a-heightmap"></a>What is a Heightmap?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Heightmaps are an efficient way of representing the shape of a hilly landscape. Not every pixel of the landscape is stored, instead, a grid of sample values is used to outline the terrain height at certain points. The heights between the samples is interpolated.</p>
</div>
<div class="paragraph">
<p>In Java, a heightmap is a float array containing height values between 0f and 255f. Here is a very simple example of a terrain generated from a heightmap with 5x5=25 height values.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/jme2/terrain-from-float-array.png" alt="terrain-from-float-array.png" width="" height=""></span></p>
</div>
<div class="paragraph">
<p>Important things to note:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Low values (e.g. 0 or 50) are valeys.</p>
</li>
<li>
<p>High values (e.g. 200, 255) are hills.</p>
</li>
<li>
<p>The heightmap only specifies a few points, and the engine interpolates the rest. Interpolation is more efficient than creating a model with several millions vertices.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When looking at Java data types to hold an array of floats between 0 and 255, the Image class comes to mind. Storing a terrain&#8217;s height values as a grayscale image has one big advantage: The outcome is a very userfriendly, like a topographical map:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Low values (e.g. 0 or 50) are dark gray – these are valleys.</p>
</li>
<li>
<p>High values (e.g. 200, 255) are light grays – these are hills.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Look at the next screenshot: In the top left you see a 128x128 grayscale image (heightmap) that was used as a base to generate the depicted terrain. To make the hilly shape better visible, the mountain tops are colored white, valleys brown, and the areas inbetween green:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/jme2/terrain-from-heightmap.png" alt="terrain-from-heightmap.png" width="" height=""></span></p>
</div>
<div class="paragraph">
<p>In a real game, you will want to use more complex and smoother terrains than the simple heightmaps shown here. Heightmaps typically have square sizes of 512x512 or 1024x1024, and contain hundred thousands to 1 million height values. No matter which size, the concept is the same as described here.</p>
</div>
<div class="sect2">
<h3 id="looking-at-the-heightmap-code"><a class="anchor" href="#looking-at-the-heightmap-code"></a>Looking at the Heightmap Code</h3>
<div class="paragraph">
<p>The first step of terrain creation is the heightmap. You can create one yourself in any standard graphic application. Make sure it has the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The size must be square, and a power of two.</p>
<div class="ulist">
<ul>
<li>
<p>Examples: 128x128, 256x256, 512x512, 1024x1024</p>
</li>
</ul>
</div>
</li>
<li>
<p>Color mode must be 255 grayscales.</p>
<div class="ulist">
<ul>
<li>
<p>Don&#8217;t supply a color image, it will be interpreted as grayscale, with possibly weird results.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Save the map as a .jpg or .png image file</p>
</li>
</ul>
</div>
<div class="imageblock text-right right text-left">
<div class="content">
<img src="../_images/jme3/beginner/mountains512.png" alt="mountains512.png" width="128" height="128">
</div>
</div>
<div class="paragraph">
<p>The file <code>mountains512.png</code> that you see here is a typical example of an image heightmap.</p>
</div>
<div class="paragraph">
<p>Here is how you create the heightmap object in your jME code:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a Texture object.</p>
</li>
<li>
<p>Load your prepared heightmap image into the texture object.</p>
</li>
<li>
<p>Create an AbstractHeightmap object from an ImageBasedHeightMap.<br>
It requires an image from a JME Texture.</p>
</li>
<li>
<p>Load the heightmap.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    AbstractHeightMap heightmap = null;
    Texture heightMapImage = assetManager.loadTexture(
            "Textures/Terrain/splat/mountains512.png");
    heightmap = new ImageBasedHeightMap(heightMapImage.getImage());
    heightmap.load();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-texture-splatting"><a class="anchor" href="#what-is-texture-splatting"></a>What is Texture Splatting?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Previously you learned how to create a material for a simple shape such as a cube. All sides of the cube have the same color. You can apply the same material to a terrain, but then you have one big meadow, one big rock desert, etc. This is not always what you want.</p>
</div>
<div class="paragraph">
<p>Texture splatting allows you create a custom material, and &#8216;paint textures&#8217; on it like with a &#8216;paint brush&#8217;. This is very useful for terrains: As you see in the example here, you can paint a grass texture into the valleys, a dirt texture onto the mountains, and free-form roads inbetween.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The jMonkeyEngine SDK comes with a <a href="#sdk/terrain_editor.adoc" class="page unresolved">TerrainEditor plugin</a>. Using the TerrainEditor plugin, you can sculpt the terrain with the mouse, and save the result as heightmap. You can paint textures on the terrain and the plugin saves the resulting splat textures as alphamap(s). The following paragraphs describe the manual process for you. You can choose to create the terrain by hand, or using the <a href="#sdk/terrain_editor.adoc" class="page unresolved">TerrainEditor plugin</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Splat textures are based on the <code>Terrain.j3md</code> material defintion. If you open the Terrain.j3md file, and look in the Material Parameters section, you see that you have several texture layers to paint on: <code>Tex1</code>, <code>Tex2</code>, <code>Tex3</code>, etc.</p>
</div>
<div class="paragraph">
<p>Before you can start painting, you have to make a few decisions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose three textures. For example grass.jpg, dirt.jpg, and road.jpg.<br>
<span class="image"><img src="../_images/jme3/beginner/grass.jpg" alt="grass.jpg" width="64" height="64"></span> <span class="image"><img src="../_images/jme3/beginner/dirt.jpg" alt="dirt.jpg" width="64" height="64"></span> <span class="image"><img src="../_images/jme3/beginner/road.jpg" alt="road.jpg" width="64" height="64"></span></p>
</li>
<li>
<p>You &#8216;paint&#8217; three texture layers by using three colors: Red, blue and, green. You arbitrarily decide that…</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Red   is grass – red   is layer <code>Tex1</code>, so put the grass texture into Tex1.</p>
</li>
<li>
<p>Green is dirt  – green is layer <code>Tex2</code>, so put the dirt  texture into Tex2.</p>
</li>
<li>
<p>Blue  is roads – blue  is layer <code>Tex3</code>, so put the roads texture into Tex3.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now you start painting the texture:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a copy of your terrains heightmap, <code>mountains512.png</code>. You want it as a reference for the shape of the landscape.</p>
</li>
<li>
<p>Name the copy <code>alphamap.png</code>.</p>
</li>
<li>
<p>Open <code>alphamap.png</code> in a graphic editor and switch the image mode to color image.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Paint the black valleys red – this will be the grass.</p>
</li>
<li>
<p>Paint the white hills green – this will be the dirt of the mountains.</p>
</li>
<li>
<p>Paint blue lines where you want roads to criss-cross the landscape.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The end result should look similar to this:<br>
<span class="image"><img src="../_images/jme3/beginner/mountains512.png" alt="mountains512.png" width="64" height="64"></span> &#8658;
 <span class="image"><img src="../_images/jme3/beginner/alphamap.png" alt="alphamap.png" width="64" height="64"></span></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="looking-at-the-texturing-code"><a class="anchor" href="#looking-at-the-texturing-code"></a>Looking at the Texturing Code</h3>
<div class="paragraph">
<p>As usual, you create a Material object. Base it on the Material Definition <code>Terrain.j3md</code> that is included in the jME3 framework.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Material mat_terrain = new Material(assetManager, "Common/MatDefs/Terrain/Terrain.j3md");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Load four textures into this material. The first one, <code>Alpha</code>, is the alphamap that you just created.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">mat_terrain.setTexture("Alpha",
    assetManager.loadTexture("Textures/Terrain/splat/alphamap.png"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The three other textures are the layers that you have previously decided to paint: grass, dirt, and road. You create texture objects and load the three textures as usual. Note how you assign them to their respective texture layers (Tex1, Tex2, and Tex3) inside the Material!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    /** 1.2) Add GRASS texture into the red layer (Tex1). */
    Texture grass = assetManager.loadTexture(
            "Textures/Terrain/splat/grass.jpg");
    grass.setWrap(WrapMode.Repeat);
    mat_terrain.setTexture("Tex1", grass);
    mat_terrain.setFloat("Tex1Scale", 64f);

    /** 1.3) Add DIRT texture into the green layer (Tex2) */
    Texture dirt = assetManager.loadTexture(
            "Textures/Terrain/splat/dirt.jpg");
    dirt.setWrap(WrapMode.Repeat);
    mat_terrain.setTexture("Tex2", dirt);
    mat_terrain.setFloat("Tex2Scale", 32f);

    /** 1.4) Add ROAD texture into the blue layer (Tex3) */
    Texture rock = assetManager.loadTexture(
            "Textures/Terrain/splat/road.jpg");
    rock.setWrap(WrapMode.Repeat);
    mat_terrain.setTexture("Tex3", rock);
    mat_terrain.setFloat("Tex3Scale", 128f);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The individual texture scales (e.g. <code>mat_terrain.setFloat("Tex3Scale", 128f);</code>) depend on the size of the textures you use.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can tell you picked too small a scale if, for example, your road tiles appear like tiny grains of sand.</p>
</li>
<li>
<p>You can tell you picked too big a scale if, for example, the blades of grass look like twigs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use <code>setWrap(WrapMode.Repeat)</code> to make the small texture fill the wide area. If the repetition is too visible, try adjusting the respective <code>Tex*Scale</code> value.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-a-terrain"><a class="anchor" href="#what-is-a-terrain"></a>What is a Terrain?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Internally, the generated terrain mesh is broken down into tiles and blocks. This is an optimization to make culling easier. You do not need to worry about &#8216;tiles&#8217; and &#8216;blocks&#8217; too much, just use recommended values for now – 64 is a good start.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume you want to generate a 512x512 terrain. You already have created the heightmap object. Here are the steps that you perform everytime you create a new terrain.</p>
</div>
<div class="paragraph">
<p>Create a TerrainQuad with the following arguments:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Specify a name: E.g. <code>my terrain</code>.</p>
</li>
<li>
<p>Specify tile size: You want to terrain tiles of size 64x64, so you supply 64+1 = 65.</p>
<div class="ulist">
<ul>
<li>
<p>In general, 64 is a good starting value for terrain tiles.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Specify block size: Since you prepared a heightmap of size 512x512, you supply 512+1 = 513.</p>
<div class="ulist">
<ul>
<li>
<p>If you supply a block size of 2x the heightmap size (1024+1=1025), you get a stretched out, wider, flatter terrain.</p>
</li>
<li>
<p>If you supply a block size 1/2 the heightmap size (256+1=257), you get a smaller, more detailed terrain.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Supply the 512x512 heightmap object that you created.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="looking-at-the-terrain-code"><a class="anchor" href="#looking-at-the-terrain-code"></a>Looking at the Terrain Code</h3>
<div class="paragraph">
<p>Here&#8217;s the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>terrain = new TerrainQuad(
  "my terrain",               // name
  65,                         // tile size
  513,                        // block size
  heightmap.getHeightMap());  // heightmap</code></pre>
</div>
</div>
<div class="paragraph">
<p>You have created the terrain object.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Remember to apply the created material:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">terrain.setMaterial(mat_terrain);</code></pre>
</div>
</div>
</li>
<li>
<p>Remember to attach the terrain to the rootNode.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">rootNode.attachChild(terrain);</code></pre>
</div>
</div>
</li>
<li>
<p>If needed, scale and translate the terrain object, just like any other Spatial.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Terrain.j3md is an unshaded material definition, so you do not need a light source. You can also use TerrainLighting.j3md plus a light, if you want a shaded terrain.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-lod-level-of-detail"><a class="anchor" href="#what-is-lod-level-of-detail"></a>What is LOD (Level of Detail)?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JME3 includes an optimization that adjusts the level of detail (LOD) of the rendered terrain depending on how close or far the camera is.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    TerrainLodControl control = new TerrainLodControl(terrain, getCamera());
    terrain.addControl(control);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Close parts of the terrain are rendered in full detail. Terrain parts that are further away are not clearly visible anyway, and JME3 improves performance by rendering them less detailed. This way you can afford to load huge terrains with no penalty caused by invisible details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercises"><a class="anchor" href="#exercises"></a>Exercises</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="exercise-1-texture-layers"><a class="anchor" href="#exercise-1-texture-layers"></a>Exercise 1: Texture Layers</h3>
<div class="paragraph">
<p>What happens when you swap two layers, for example <code>Tex1</code> and <code>Tex2</code>?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">...
mat_terrain.setTexture("Tex2", grass);
...
mat_terrain.setTexture("Tex1", dirt);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You see it&#8217;s easier to swap layers in the code, than to change the colors in the alphamap.</p>
</div>
</div>
<div class="sect2">
<h3 id="exercise-2-randomized-terrains"><a class="anchor" href="#exercise-2-randomized-terrains"></a>Exercise 2: Randomized Terrains</h3>
<div class="paragraph">
<p>The following three lines generate the heightmap object based on your user-defined image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    AbstractHeightMap heightmap = null;
    Texture heightMapImage = assetManager.loadTexture(
        "Textures/Terrain/splat/mountains512.png");
    heightmap = new ImageBasedHeightMap(heightMapImage.getImage());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead, you can also let JME3 generate a random landscape for you:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>What result do you get when you replace the above three heightmap lines by the following lines and run the sample?</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">HillHeightMap heightmap = null;
HillHeightMap.NORMALIZE_RANGE = 100; // optional
try {
    heightmap = new HillHeightMap(513, 1000, 50, 100, (byte) 3); // byte 3 is a random seed
} catch (Exception ex) {
    ex.printStackTrace();
}</code></pre>
</div>
</div>
</li>
<li>
<p>Change one parameter at a time, and the run the sample again. Note the differences. Can you find out which of the values has which effect on the generated terrain (look at the javadoc also)?</p>
<div class="ulist">
<ul>
<li>
<p>Which value controls the size?</p>
<div class="ulist">
<ul>
<li>
<p>What happens if the size is not a square number +1 ?</p>
</li>
</ul>
</div>
</li>
<li>
<p>Which value controls the number of hills generated?</p>
</li>
<li>
<p>Which values control the size and steepness of the hills?</p>
<div class="ulist">
<ul>
<li>
<p>What happens if the min is bigger than or equal to max?</p>
</li>
<li>
<p>What happens if both min and max are small values (e.g. 10/20)?</p>
</li>
<li>
<p>What happens if both min and max are large values (e.g. 1000/1500)?</p>
</li>
<li>
<p>What happens if min and max are very close(e.g. 1000/1001, 20/21)? Very far apart (e.g. 10/1000)?</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You see the variety of hilly landscapes that can be generated using this method.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For this exercise, you can keep using the splat Material from the sample code above. Just don&#8217;t be surprised that the Material does not match the shape of the newly randomized landscape. If you want to generate real matching splat textures for randomized heightmaps, you need to write a custom method that, for example, creates an alphamap from the heightmap by replacing certain grayscales with certain RGB values.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="exercise-3-solid-terrains"><a class="anchor" href="#exercise-3-solid-terrains"></a>Exercise 3: Solid Terrains</h3>
<div class="paragraph">
<p>Can you combine what you learned here and in <a href="#jme3/beginner/hello_collision.adoc" class="page unresolved">Hello Collision</a>, and <a href="#jme3/advanced/terrain_collision.adoc" class="page unresolved">make the terrain solid</a>?</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion"><a class="anchor" href="#conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have learned how to create terrains that are more efficient than loading one giant model. You know how to generate random or create handmade heightmaps. You can add a LOD control to render large terrains faster. You are aware that you can combine what you learned about collision detection to make the terrain solid to a physical player. You are also able to texture a terrain “like a boss using layered Materials and texture splatting. You are aware that the jMonkeyEngine SDK provides a TerrainEditor that helps with most of these manual tasks.</p>
</div>
<div class="paragraph">
<p>Do you want to hear your players say &#8216;ouch!&#8217; when they bump into a wall or fall off a hill? Continue with learning <a href="#jme3/beginner/hello_audio.adoc" class="page unresolved">how to add sound</a> to your game.</p>
</div>
<hr>
<div class="paragraph">
<p>See also:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#jme3/advanced/terrain_collision.adoc" class="page unresolved">Terrain Collision</a></p>
</li>
<li>
<p><a href="#jme3/advanced/terrain.html" class="page unresolved">Advanced Terrain</a></p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="hello_collision.html">Hello Collision</a></span>
  <span class="next"><a href="hello_audio.html">Hello Audio</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright 2020 jMonkeyEngine Wiki Contributors. Licensed BSD-3.</p>
</footer>
<script src="../../../_/js/vendor/docsearch.min.js"></script>
<!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
<script>
var search = docsearch({
  apiKey: '',
  indexName: '',
  inputSelector: '#search-input',
  autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
  algoliaOptions: { hitsPerPage: 10 }
}).autocomplete
search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
function focusSearchInput () { document.querySelector('#search-input').focus() }
if (document.querySelector('.home-link.is-current')) window.addEventListener('load', focusSearchInput)
</script>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
